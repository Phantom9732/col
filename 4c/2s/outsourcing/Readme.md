##  **ТЕХНИЧЕСКОЕ ЗАДАНИЕ ДЛЯ BACKEND**

---

### **Задача 1: API для создания задачи с подзадачами и файлами**

**Цель работы**  
Реализовать RESTful API-эндпоинт, позволяющий пользователям создавать задачи с полным набором атрибутов: описание, исполнитель, приоритет, дедлайн, подзадачи и прикреплённые файлы. Это ключевая функция системы управления задачами и должна поддерживать как веб-интерфейс, так и интеграции (например, через Jira).

**Описание задачи**  
Необходимо разработать POST-метод по маршруту `/api/v1/tasks` с валидацией входных данных, транзакционной целостностью и безопасной обработкой файлов.  
Подзадачи должны создаваться рекурсивно в рамках одной транзакции. Файлы не хранятся на сервере напрямую - система принимает только ссылки на объекты в облачном хранилище (например, AWS S3 или MinIO), предварительно загруженные через отдельный endpoint `/api/v1/upload`.

**Формат запроса (JSON)**  
```json
{
  "title": "Интеграция с Slack",
  "description": "Настроить отправку уведомлений в канал #tasks при изменении статуса",
  "assignee_id": 42,
  "reporter_id": 15,
  "project_id": 7,
  "priority": "high",
  "due_date": "2025-11-05T18:00:00Z",
  "status": "new",
  "subtasks": [
    {
      "title": "Настроить вебхук в Slack",
      "assignee_id": 43
    },
    {
      "title": "Реализовать отправку уведомлений",
      "assignee_id": 42
    }
  ],
  "attachments": [
    "https://storage.taskflow.pro/techsolutions/slack-webhook-guide.pdf"
  ]
}
```

**Требования к валидации**  
- `title` - обязательное, 1–255 символов  
- `due_date` - не может быть в прошлом  
- `assignee_id` и `project_id` - должны существовать в БД  
- `priority` - одно из: `"low"`, `"normal"`, `"high"`, `"critical"`  
- `attachments` - каждая ссылка должна быть HTTPS и соответствовать домену хранилища

**Ответ сервера (201 Created)**  
```json
{
  "id": 1024,
  "title": "Интеграция с Slack",
  "status": "new",
  "created_at": "2025-10-18T14:30:00Z",
  "url": "/tasks/1024"
}
```

**ERD (сущности)**  
- `tasks` (id, title, description, status, priority, due_date, created_at, updated_at, project_id, assignee_id, reporter_id)  
- `subtasks` (id, task_id, title, status, assignee_id)  
- `attachments` (id, task_id, url)

---

### **Задача 2: API получения списка задач с фильтрацией и пагинацией**

**Цель работы**  
Предоставить возможность фильтрации задач по проекту, статусу, приоритету, исполнителю и дедлайну.

**Описание задачи**  
GET `/api/v1/tasks` с поддержкой query-параметров:  
- `project_id` (int)  
- `status` (string, multi-value: `?status=new&status=in_progress`)  
- `priority` (string)  
- `assignee_id` (int)  
- `due_before`, `due_after` (ISO 8601)  
- `page`, `limit` (пагинация, по умолчанию: page=1, limit=20)

**Ответ сервера (200 OK)**  
```json
{
  "items": [
    {
      "id": 1024,
      "title": "Интеграция с Slack",
      "status": "new",
      "priority": "high",
      "due_date": "2025-11-05T18:00:00Z",
      "assignee": { "id": 42, "name": "Иван Петров" },
      "project": { "id": 7, "name": "Интеграции" }
    }
  ],
  "total": 42,
  "page": 1,
  "limit": 20
}
```

---

### **Задача 3: Входящая синхронизация с Jira (вебхуки)**

**Цель работы**  
Автоматически импортировать задачи из Jira в TaskFlow Pro при их создании или обновлении, чтобы обеспечить единое пространство задач.

**Описание задачи**  
- Реализовать endpoint `/api/v1/integrations/jira/webhook`  
- Поддерживать события: `issue_created`, `issue_updated`  
- Маппинг:  
  - Jira `summary` → `title`  
  - Jira `description` → `description`  
  - Jira `assignee` → `assignee_id` (по email)  
  - Jira `priority` → `"low"/"normal"/"high"`  
  - Jira `status` → `"new"/"in_progress"/"done"` (согласно настройкам маппинга в админке)

**Безопасность**:  
- Проверка `X-Hub-Signature` заголовка  
- Логирование всех событий в `jira_sync_log`

---

### **Задача 4: Система уведомлений (email + Slack)**

**Цель работы**  
Обеспечить своевременное информирование пользователей о важных событиях: назначение задачи, приближение дедлайна, изменение статуса.

**Триггеры**  
1. Назначение задачи → уведомление исполнителю  
2. Изменение статуса → уведомление репортеру  
3. Дедлайн через 24 часа → напоминание исполнителю и репортеру

**Интеграции**  
- Email: через SendGrid или SMTP  
- Slack: отправка в DM или канал (настраивается в профиле)

**Архитектура**:  
- Очередь задач (RabbitMQ или Redis)  
- Worker-процесс для отправки

---

### **Задача 5: Мониторинг дискового пространства и алертинг**

**Цель работы**  
Предотвратить отказ системы из-за переполнения диска в облачном хранилище.

**Описание задачи**  
- Ежечасный cron-скрипт проверяет использование хранилища через MinIO API  
- Если usage > 85% → отправка алерта в Slack-канал `#infra-alerts` и email админу  
- Логирование в `system_monitoring` таблицу

---

## **ТЕХНИЧЕСКОЕ ЗАДАНИЕ ДЛЯ FRONTEND**

---

### **Задача 1: Форма создания задачи**

**Цель работы**  
Предоставить пользователю интуитивно понятный интерфейс для быстрого создания задачи с подзадачами и файлами без необходимости обучения.

**Что отправляем на сервер**  
- JSON-объект (см. Backend Задача 1)  
- Файлы загружаются через `/api/v1/upload` → возвращаются URL → вставляются в `attachments`

**Что получаем**  
- ID новой задачи → редирект на `/tasks/1024`  
- При ошибке - отображение сообщений валидации под полями

**Дополнительная информация**  
- Использовать компоненты из дизайн-системы Figma: [figma.com/file/taskflow-pro/forms](https://figma.com/file/taskflow-pro/forms)  
- Поддержка drag & drop для файлов  
- Автосохранение черновика в localStorage каждые 30 секунд

---

### **Задача 2: Панель мониторинга (Dashboard)**

**Цель работы**  
Дать руководителю проекта визуальное представление о прогрессе: сколько задач в работе, просрочено, завершено.

**Что отправляем**  
- GET `/api/v1/tasks?project_id=7&status=new,in_progress,done`

**Что получаем**  
- Список задач → отрисовка:  
  - График выполнения (Chart.js: столбцы по статусам)  
  - Список просроченных задач (красная иконка ⚠️)  
  - Фильтры: приоритет, исполнитель, дедлайн

**Дополнительно**  
- Автообновление каждые 5 минут  
- Кнопка «Экспорт в Excel» → вызов `/api/v1/tasks/export?project_id=7`

---

### **Задача 3: Страница детализации задачи**

**Цель работы**  
Позволить пользователю просматривать, комментировать и изменять статус задачи.

**Функции**  
- Отображение истории изменений (кто и когда менял статус)  
- Поле комментариев с поддержкой @упоминаний (WebSocket)  
- Кнопка «Завершить» → PATCH `/api/v1/tasks/1024` с `{"status": "done"}`

---

### **Задача 4: Интеграция с Slack**

**Цель работы**  
Позволить отправлять информацию о задаче в Slack одним кликом.

**Действие**  
- На странице задачи - кнопка «Отправить в Slack»  
- POST `/api/v1/integrations/slack/notify` с телом:  
  ```json
  { "task_id": 1024, "channel": "DM", "message": "Напоминание: задача просрочена!" }
  ```

---

### **Задача 5: Адаптивная навигация**

**Цель работы**  
Обеспечить удобную работу на мобильных устройствах.

**Требования**  
- При ширине < 768px:  
  - Меню сворачивается в гамбургер  
  - Карточки задач - вертикальный список с иконками статуса  
  - Форма создания - одно поле на экране (пошагово)

---

## **ТЕХНИЧЕСКОЕ ЗАДАНИЕ ДЛЯ ДИЗАЙНА**

---

### **Задача 1: Макет главной страницы (Dashboard)**

**Цель работы**  
Создать информативный и визуально сбалансированный интерфейс, позволяющий пользователю сразу оценить состояние проектов.

**Элементы интерфейса**  
- **Шапка**: логотип, поиск по задачам, уведомления (колокольчик), аватар профиля  
- **Левая панель**:  
  - Список проектов (с иконками)  
  - Кнопка «+ Новый проект»  
- **Центр**:  
  - Фильтры: статус, приоритет, исполнитель (чипсы)  
  - Список карточек задач:  
    - Цветная метка приоритета (🔴/🟡/🟢)  
    - Иконка статуса  
    - Имя исполнителя + аватар  
    - Дедлайн (красный, если просрочен)  
- **Правая панель**:  
  - График «Выполнено / В работе»  
  - Блок «Просроченные задачи» (макс. 3)

**Прикреплённое изображение**:  
*(в реальной работе - ссылка на Figma или PNG)*

---

### **Задача 2: Макет формы создания задачи**

**Цель работы**  
Минимизировать когнитивную нагрузку и количество действий при создании задачи.

**Элементы интерфейса**  
- Поле заголовка (автофокус при открытии)  
- Rich-текст редактор (жирный, курсив, списки, вставка ссылок)  
- Выбор проекта (выпадающий список с поиском)  
- Выбор исполнителя (автокомплит по имени/email)  
- Календарь с возможностью выбора времени (дедлайн)  
- Переключатель приоритета (иконки вместо текста)  
- Блок «Подзадачи»:  
  - Кнопка «+ Добавить подзадачу»  
  - Для каждой - поле заголовка + выбор исполнителя  
- Загрузка файлов:  
  - Кнопка «Прикрепить файлы»  
  - Область drag & drop  
  - Превью загруженных файлов с иконками (PDF, DOC, PNG)

**Требования к UX**  
- Все обязательные поля отмечены *  
- Ошибки валидации появляются сразу под полем  
- Кнопка «Создать» активна только при заполнении `title` и `project`

